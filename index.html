<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Create By Sahal Arbani</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"  rel="stylesheet"/>
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"  rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">

  <style>
    body {
  font-family: 'Amiri', sans-serif;
  color: white;
  transition: background 0.3s ease;
  margin-top: 60px;
  overflow-x: hidden;
}

    .bg-gradient-purple {
      background: linear-gradient(135deg, #6a11cb, #2575fc);
    }

    .btn-blue-pill {
      background: linear-gradient(to right, #00c6ff, #0072ff);
      border-radius: 50px;
      color: white;
      border: none;
      padding: 0.5rem 1.2rem;
      font-size: 1rem;
    }

    .btn-blue-pill:hover {
      background: linear-gradient(to right, #b500cf, #7e00a3);
    }

    .glass-card {
      backdrop-filter: blur(10px);
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      border: 1px solid rgba(255, 255, 255, 0.18);
      padding: 1rem;
      color: white;
    }

    .verse-number-box {
      display: inline-block;
      background-color: rgba(255, 255, 255, 0.2);
      color: white;
      font-size: 0.98rem;
      padding: 0.4rem 0.7rem;
      border-radius: 50%;
      margin-right: 0.5rem;
    }

    .verse-text-arab {
      font-size: 1.8rem;
      direction: rtl;
      line-height: 2.2;
      font-family: 'Amiri', serif;
    }

    .verse-container {
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 1rem;
      padding: 1rem;
      margin-bottom: 1rem;
      transition: background-color 0.3s;
    }

    .dark-mode {
      background: #121212 !important;
      color: #fff !important;
    }

    .page {
      display: none;
    }

    .active {
      display: block;
    }

    .loading {
      text-align: center;
      padding: 2rem;
      font-size: 1.2rem;
      display: none;
    }

    #audioPlayer {
      display: none;
    }

    .navbar-sticky {
      position: fixed;
      top: -30px;
      width: 100%;
      z-index: 9999;
      display: none;
    }

    .verse-container.playing {
      background: linear-gradient(to right, #ff00c532, #1200ea3e);
      transition: background-color 0.5s ease;
    }
    .navbar-brand{
      color:  white;
    }
.verse-number-box {
  position: relative;
  display: inline-block;
  width: 36px;
  height: 36px;
  font-size: 0.85rem;
  color: white;
}

.verse-number-icon {
  font-size: 2rem;
  color: inherit;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;
}

.verse-number-text {
  position: absolute;
  top: 60%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
  font-weight: bold;
}

    @media (max-width: 576px) {
      .verse-text-arab {
        font-size: 2rem;
      }
      .verse-number-box {
        font-size: 1.0rem;
        padding: 0.5rem 0.8rem;
      }
      .card-title {
        font-size: 1.2rem;
      }
      .verse-container {
        padding: 1rem;
      }
      .btn-blue-pill {
        font-size: 0.95rem;
        padding: 0.5rem 1rem;
      }
    }
  </style>
</head>
<body class="bg-gradient-purple text-light dark-mode">
<!--tes-->
<div id="tahlilPage" class="container glass my-4 p-4 page">
  <h2 class="text-center mb-4">Tahlil</h2>
  <div id="tahlilContent" class="verse-container p-3"></div>
  <button onclick="showPage('homePage')" class="btn btn-blue-pill mt-3 w-100">
    <i class="bi bi-arrow-left-circle"></i> Kembali
  </button>
</div>

<div id="tahlilDetailPage" class="container glass my-4 p-4 page">
  <h2 id="tahlilTitle" class="text-center mb-4"></h2>
  <div class="verse-container p-3">
    <p><strong>No:</strong> <span id="tahlilNo"></span></p>
    <p><strong>Judul:</strong> <span id="tahlilJudul"></span></p>
    <div class="verse-text-arab mb-3" style="font-size:1.6rem; font-family:'Amiri', serif;" id="tahlilArab"></div>
    <p id="tahlilId"></p>
  </div>
  <button onclick="showPage('tahlilPage')" class="btn btn-blue-pill mt-3 w-100">
    <i class="bi bi-arrow-left-circle"></i> Kembali
  </button>
</div>
<!--ywsin-->
<div id="hadrohPage" class="container glass my-4 p-4 page">
  <h2 class="text-center mb-4">Daftar Hadroh</h2>
  <div id="hadrohList" class="row g-3"></div>
  <button onclick="showPage('homePage')" class="btn btn-blue-pill mt-3 w-100">
    <i class="bi bi-arrow-left-circle"></i> Kembali
  </button>
</div>

<!-- Sticky Navbar -->
<nav id="navbarSticky" class="navbar navbar-expand-lg bg-transparent navbar-sticky">
  <div class="container-fluid">
    <span id="navSurahTitle" class="navbar-brand d-none"></span>
    <div class="d-flex ms-auto">
      <button id="backBtn" class="btn btn-blue-pill me-2"><i class="bi bi-arrow-left-circle"></i></button>
      <select id="qoriSelect" class="form-select form-select-sm me-2 btn-blue-pill">
        <option value="01">Abdullah Al-Juhany</option>
        <option value="02">Abdul Muhsin Al-Qasim</option>
        <option value="03">Abdurrahman As-Sudais</option>
        <option value="04">Ibrahim Al-Dossari</option>
        <option value="05">Misyari Rasyid Al-Afasi</option>
      </select>
      <button id="stopAudioBtn" class="btn btn-blue-pill me-2"><i class="bi bi-stop-circle-fill"></i></button>
      <button id="playAllBtn" class="btn btn-blue-pill me-2"><i class="bi bi-play-circle-fill"></i></button>
   <button class="btn btn-blue-pill" data-dark-mode>
    <i class="bi bi-moon-fill" id="darkModeIcon"></i>
  </button>
    </div>
  </div>
</nav>

<!-- Loading Spinner -->
<div class="loading" id="loadingSpinner"><i class="bi bi-arrow-clockwise"></i>
  Sedang memuat data...</div>

<!-- Pages -->.
<div id="homePage" class="container my-4 p-4 active page">
<!-- Sidebar -->
<nav class="navbar navbar-expand-lg  fixed-top" id="mainNav">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html"><i class="bi bi-book-half"></i> Create By Sahal Arbani </a>
  <button class="btn btn-sm btn-blue-pill ms-auto me-2" data-dark-mode>
    <i class="bi bi-moon-fill" id="darkModeIcon"></i>
  </button>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
  <div class="collapse navbar-collapse" id="sidebarMenu">
    <ul class="nav flex-column p-3">
      <li class="nav-item">
        <a class="nav-link text-white" onclick="showPage('homePage')">Surah</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-white" onclick="showPage('tahlilPage')">Tahlil</a>
      </li>
<li class="nav-item">
  <a class="nav-link text-white" onclick="showPage('hadrohPage')">Hadroh</a>
</li>
    </ul>
  </div>
</nav>
  <h2 class="text-center mb-4">Daftar Surah Al-Qur'an</h2>
  <input type="text" id="searchInput" class="form-control mb-3" placeholder="Cari Surah..." />
  <div id="surahList" class="row g-3"></div>
</div>

<div id="detailPage" class="container glass my-4 p-4 page">
  <h2 id="surahName" class="text-center mb-4"></h2>
  <div id="versesContainer" class="mt-3"></div>
</div>

<!-- Hidden Audio Player -->
<audio id="audioPlayer" controls></audio>

<script>
  const API_URL = "https://equran.id/api/v2"; 
  let allSurahs = [];
  let currentVerseIndex = 0;
  let versesData = [];

  function setupDarkModeToggle() {
  const buttons = document.querySelectorAll("[data-dark-mode]");
  buttons.forEach(btn => {
    btn.removeEventListener("click", toggleDarkMode);
    btn.addEventListener("click", toggleDarkMode);
  });
}

function toggleDarkMode() {
  const isDark = document.body.classList.toggle("dark-mode");
  const icon = document.querySelector("#darkModeToggle i");

  if (document.body.classList.contains("dark-mode")) {
    icon.classList.replace("bi-moon-fill", "bi-sun-fill");
    updateVantaBackground(true);
  } else {
    icon.classList.replace("bi-sun-fill", "bi-moon-fill");
    updateVantaBackground(false);
  }
}

  function showLoading(show) {
    const spinner = document.getElementById("loadingSpinner");
    spinner.style.display = show ? "block" : "none";
  }

  async function loadSurahList() {
    showLoading(true);
    const res = await fetch(`${API_URL}/surat`);
    const data = await res.json();
    allSurahs = data.data;
    const list = document.getElementById("surahList");
    list.innerHTML = "";
    allSurahs.forEach((s) => {
      const card = `
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card glass-card">
            <div class="card-body">
              <h5 class="card-title">${s.namaLatin} (${s.nomor})</h5>
              <p class="card-text m-0"><strong>Nama:</strong> ${s.nama}</p>
              <p class="card-text m-0"><strong>Jumlah Ayat:</strong> ${s.jumlahAyat}</p>
              <p class="card-text m-0"><strong>Tempat Turun:</strong> ${s.tempatTurun}</p>
              <p class="card-text m-0"><strong>Arti:</strong> ${s.arti}</p>
              <button onclick="showDetail(${s.nomor})" class="btn btn-blue-pill mt-2 w-100">
                <i class="bi bi-journal-text"></i> Buka
              </button>
            </div>
          </div>
        </div>`;
      list.innerHTML += card;
    });
    setupSearch(allSurahs);
    showLoading(false);
  }

  function setupSearch(surahData) {
    document.getElementById("searchInput").addEventListener("input", (e) => {
      const term = e.target.value.toLowerCase();
      const filtered = surahData.filter(
        (s) =>
          s.nama.toLowerCase().includes(term) ||
          s.namaLatin.toLowerCase().includes(term) ||
          s.nomor.toString().includes(term)
      );
      const list = document.getElementById("surahList");
      list.innerHTML = "";
      filtered.forEach((s) => {
        const card = `
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card glass-card">
              <div class="card-body">
                <h5 class="card-title">${s.namaLatin} (${s.nomor})</h5>
                <p class="card-text m-0"><strong>Nama:</strong> ${s.nama}</p>
                <p class="card-text m-0"><strong>Jumlah Ayat:</strong> ${s.jumlahAyat}</p>
                <p class="card-text m-0"><strong>Tempat Turun:</strong> ${s.tempatTurun}</p>
                <p class="card-text m-0"><strong>Arti:</strong> ${s.arti}</p>
                <button onclick="showDetail(${s.nomor})" class="btn btn-blue-pill mt-2 w-100">
                  <i class="bi bi-journal-text"></i> Buka
                </button>
              </div>
            </div>
          </div>`;
        list.innerHTML += card;
      });
    });
  }

  async function showDetail(nomor) {
    showLoading(true);
    const res = await fetch(`${API_URL}/surat/${nomor}`);
    const data = await res.json();
    const surah = data.data;
    versesData = surah.ayat;
    document.getElementById("surahName").innerText = `${surah.namaLatin} (${surah.nomor})`;
    document.getElementById("navSurahTitle").textContent = surah.namaLatin;
    document.getElementById("navSurahTitle").classList.remove("d-none");

    const container = document.getElementById("versesContainer");
    container.innerHTML = "";
    surah.ayat.forEach((a, index) => {
const verseBox = `
  <div class="verse-container d-flex flex-column">
    <div class="d-flex align-items-start">
      <span class="verse-number-box">
        <i class="bi bi-heptagon verse-number-icon"></i>
        <span class="verse-number-text">${a.nomorAyat}</span>
      </span>
      <div class="flex-grow-1">
        <div class="verse-text-arab">${a.teksArab}</div>
        <p><strong>${a.teksLatin}</strong></p>
        <p>${a.teksIndonesia}</p>
      </div>
      <button onclick="playVerse(${index})" class="btn btn-blue-pill ms-2">
        <i class="bi bi-volume-up-fill"></i>
      </button>
    </div>
  </div>`;
      container.innerHTML += verseBox;
    });
    showLoading(false);
    showPage("detailPage");
    document.getElementById("navbarSticky").style.display = "block";
  }

  function playVerse(index) {
    currentVerseIndex = index;
    const selectedQori = document.getElementById("qoriSelect").value;
    const verse = versesData[currentVerseIndex];
    const audio = document.getElementById("audioPlayer");
    audio.src = verse.audio[selectedQori];
    audio.play();

    const verses = document.querySelectorAll('.verse-container');
    if (verses[currentVerseIndex]) {
      verses[currentVerseIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
      document.querySelectorAll('.verse-container').forEach(el => el.classList.remove('playing'));
      verses[currentVerseIndex].classList.add('playing');
    }
  }

  document.getElementById("playAllBtn").addEventListener("click", () => {
    if (versesData.length === 0) return;
    currentVerseIndex = 0;
    playNextVerse();
  });

  function playNextVerse() {
    const audio = document.getElementById("audioPlayer");
    const selectedQori = document.getElementById("qoriSelect").value;
    const verse = versesData[currentVerseIndex];
    if (!verse) return;

    audio.src = verse.audio[selectedQori];
    audio.play();

    const verses = document.querySelectorAll('.verse-container');
    if (verses[currentVerseIndex]) {
      verses[currentVerseIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
      document.querySelectorAll('.verse-container').forEach(el => el.classList.remove('playing'));
      verses[currentVerseIndex].classList.add('playing');
    }

    audio.onended = () => {
      if (currentVerseIndex < versesData.length - 1) {
        currentVerseIndex++;
        playNextVerse();
      }
    };
  }

  document.getElementById("stopAudioBtn").addEventListener("click", () => {
    const audio = document.getElementById("audioPlayer");
    audio.pause();
    audio.currentTime = 0;
  });
// Load daftar tahlil
async function loadTahlil() {
  showLoading(true);
  const content = document.getElementById("tahlilContent");
  content.innerHTML = ""; // Kosongkan dulu

  try {
    const res = await fetch("tahlil.json");
    if (!res.ok) throw new Error("File tahlil.json tidak ditemukan");

    const data = await res.json();

    if (!data.status || !Array.isArray(data.result)) {
      throw new Error("Format JSON tidak valid");
    }

    data.result.forEach((item) => {
      const html = `
        <div class="mb-4 pb-4 border-bottom border-white">
          <h4>${item.judul}</h4>
          <div class="verse-text-arab mb-3" style="font-size:1.6rem; font-family:'Amiri', serif;">
            ${item.arab}
          </div>
          <p>${item.id}</p>
        </div>`;
      content.innerHTML += html;
    });

  } catch (err) {
    console.error(err);
    content.innerHTML = `<div class="text-danger">Gagal memuat bacaan tahlil: ${err.message}</div>`;
  }

  showLoading(false);
}

// Tampilkan detail tahlil
function showTahlilDetail(no) {
  fetch("tahlil.json")
    .then(res => res.json())
    .then(data => {
      const item = data.result.find(i => i.no === no);
      if (item) {
        document.getElementById("tahlilTitle").innerText = item.judul;
        document.getElementById("tahlilNo").innerText = item.no;
        document.getElementById("tahlilJudul").innerText = item.judul;
        document.getElementById("tahlilArab").innerHTML = item.arab;
        document.getElementById("tahlilId").innerText = item.id;
        showPage("tahlilDetailPage");
      }
    });
}
async function loadHadroh() {
  const list = document.getElementById("hadrohList");
  list.innerHTML = ""; // Kosongkan dulu

  try {
    const res = await fetch("hadroh.json"); // Pastikan file tersedia
    if (!res.ok) throw new Error("File hadroh.json tidak ditemukan");

    const data = await res.json();
    if (!data.status || !Array.isArray(data.result)) {
      throw new Error("Format JSON tidak valid");
    }

    data.result.forEach((item) => {
      const card = `
        <div class="col-12">
          <div class="card glass-card">
            <div class="card-body">
              <h5 class="card-title">${item.nama}</h5>
              ${item.ayah ? `<p class="card-text m-0"><strong>Ayah:</strong> ${item.ayah}</p>` : ""}
            </div>
          </div>
        </div>`;
      list.innerHTML += card;
    });

  } catch (err) {
    console.error(err);
    list.innerHTML = `<div class="text-danger">Gagal memuat data hadroh: ${err.message}</div>`;
  }
}
  
  
  function showPage(pageId) {
  document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
  document.getElementById(pageId).classList.add("active");

  setupDarkModeToggle(); // Penting: Pasang ulang event listener

  if (pageId === 'tahlilPage') {
    loadTahlil();
  }

  if (pageId !== "detailPage") {
    document.getElementById("navbarSticky").style.display = "none";
  }

  if (pageId === 'hadrohPage') {
    loadHadroh(); // Load data hadroh saat halaman dibuka
  }
  
}

  document.getElementById("backBtn").addEventListener("click", () => {
    showPage("homePage");
    document.getElementById("navbarSticky").style.display = "none";
  });


  window.onload = () => {
    loadSurahList();
  };
</script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> 
<!-- Vanta.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/three@0.119.1/build/three.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script> 
<script>
  // Inisialisasi Vanta Net
  let vantaEffect;

  window.addEventListener('load', () => {
    vantaEffect = VANTA.NET({
      el: "body",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200.00,
      minWidth: 200.00,
      scale: 1.00,
      scaleMobile: 1.00,
      color: 0x2a1d8f,
      backgroundColor: 0x121212,
      points: 10.00,
      maxDistance: 25.00
    });
  });

  // Optional: Update warna untuk dark mode
  function updateVantaBackground(isDarkMode) {
    if (vantaEffect) {
      vantaEffect.setOptions({
        color: isDarkMode ? 0xffffff : 0x2a1d8f,
        backgroundColor: isDarkMode ? 0x000000 : 0x121212
      });
    }
  }
</script>
</body>
</html>